<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>First bounty, time to step up my game | kciredor’s software and security blog</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="First bounty, time to step up my game" />
<meta name="author" content="Roderick Schaefer" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="What happened Hello again and thanks for reading my second blog post! After publishing my first blog I kept on trying to hack different companies and websites. Not as easy as I had hoped for! It took me quite some time to find another security issue after the IDOR in my first month. This SOME issue I found is not to be made public, so I won’t be able to mention company details and will have to mask url’s etc." />
<meta property="og:description" content="What happened Hello again and thanks for reading my second blog post! After publishing my first blog I kept on trying to hack different companies and websites. Not as easy as I had hoped for! It took me quite some time to find another security issue after the IDOR in my first month. This SOME issue I found is not to be made public, so I won’t be able to mention company details and will have to mask url’s etc." />
<link rel="canonical" href="https://kciredor.com/first-bounty-time-to-step-up-my-game.html" />
<meta property="og:url" content="https://kciredor.com/first-bounty-time-to-step-up-my-game.html" />
<meta property="og:site_name" content="kciredor’s software and security blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-09-19T15:20:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="First bounty, time to step up my game" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Roderick Schaefer"},"dateModified":"2017-09-19T15:20:00+02:00","datePublished":"2017-09-19T15:20:00+02:00","description":"What happened Hello again and thanks for reading my second blog post! After publishing my first blog I kept on trying to hack different companies and websites. Not as easy as I had hoped for! It took me quite some time to find another security issue after the IDOR in my first month. This SOME issue I found is not to be made public, so I won’t be able to mention company details and will have to mask url’s etc.","headline":"First bounty, time to step up my game","mainEntityOfPage":{"@type":"WebPage","@id":"https://kciredor.com/first-bounty-time-to-step-up-my-game.html"},"url":"https://kciredor.com/first-bounty-time-to-step-up-my-game.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://kciredor.com/feed.xml" title="kciredor's software and security blog" /><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BHW0E1E3RC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-BHW0E1E3RC');
</script>
  
</head>
<body><header class="site-header" role="banner">
  <div class="wrapper">
    
    
    <a class="site-title" href="/">kciredor&#39;s software and security blog</a>
 
    
  </div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">First bounty, time to step up my game</h1>
    <p class="post-meta">
      <time datetime="2017-09-19T15:20:00+02:00" itemprop="datePublished">
        
        Sep 19, 2017
      </time>
      <i>&nbsp;&nbsp;[ bugbounty xss ]</i>
      </p>
      <div class="post-sharing">
  <a rel="noopener noreferrer nofollow" target="_blank" href="https://twitter.com/intent/tweet?text=&quot;First bounty, time to step up my game&quot; by @kciredor_&url=https://kciredor.com/first-bounty-time-to-step-up-my-game.html&related=kciredor_"><img src="/assets/icon_twitter.png" alt="Twitter" title=""></a>
  <a rel="noopener noreferrer nofollow" target="_blank" href="http://www.reddit.com/submit?url=https://kciredor.com/first-bounty-time-to-step-up-my-game.html&title=First bounty, time to step up my game"><img src="/assets/icon_reddit.png" alt="Reddit" title=""></a>
  <a rel="noopener noreferrer nofollow" target="_blank" href="https://www.linkedin.com/sharing/share-offsite/?url=https://kciredor.com/first-bounty-time-to-step-up-my-game.html"><img src="/assets/icon_linkedin.png" alt="LinkedIn" title=""></a>
  <a rel="noopener noreferrer nofollow" target="_blank" href="https://facebook.com/sharer.php?href=https://kciredor.com/first-bounty-time-to-step-up-my-game.html&display=popup"><img src="/assets/icon_facebook.png" alt="Facebook" title=""></a>
</div>

      <p></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <h1 id="what-happened">What happened</h1>
<p>Hello again and thanks for reading my second blog post! After publishing my <a href="/my-first-month-as-a-full-time-bug-bounty-hunter.html">first blog</a> I kept on trying to hack different companies and websites. Not as easy as I had hoped for! It took me quite some time to find another security issue after the IDOR in my <a href="/my-first-month-as-a-full-time-bug-bounty-hunter.html">first month</a>. This SOME issue I found is not to be made public, so I won’t be able to mention company details and will have to mask url’s etc.</p>

<h1 id="some-attack">SOME attack</h1>
<p>Extensive recon of different websites owned by my target company learned that they were using an old version of an upload plugin. This plugin attempts to allow user uploads for as many different browsers and versions as possible and includes a flash component. Funny thing is this flash component was vulnerable to XSS:</p>

<figure class="highlight"><pre><code class="language-url" data-lang="url">https://company.com/lib/upload.swf/?target%g=alert&amp;uid%g=kciredor</code></pre></figure>

<p>This wil pop an alert box containing kciredor. How did I know? While browsing the website and proxying everything through Burp to create a sitemap, the Retire.js chrome extension pointed out that this specific library was out of date. So I started looking into it and searched for published issues.</p>

<p>So far so good but it does not end with an alert of my nickname. Can I also alert document.cookie for instance? The anwser is: no. Simply reporting this XSS right now would end up getting myself in trouble, because I cannot prove exploitability. Cloning the library from github including submodules and browsing through the code I found out the target parameter has a regex filter like this: a-zA-Z0-9._ and the uid parameter has a regex filter like this: a-zA-Z0-9_ which does not leave us a lot of room to get things done.</p>

<p>This is where I want to thank smiegles for giving me a heads up on SOME attacks: Same Origin Method Execution. There’s even a PoC to get inspired! The impact of SOME attacks is roughly the same as XSS. Using only alphanumeric input and a dot is enough to make a SOME attack work, meaning this could do the trick! Ben Hayak wrote an excellent <a href="http://files.benhayak.com/Same_Origin_Method_Execution__paper.pdf">whitepaper</a> on these kind of attacks.</p>

<p>In the context of the website I was attacking I tried to build a DOM path to the user profile delete button, but to no avail: yes it calls the delete profile function but there’s a confirm box asking if you really want to delete your profile. This kind of user interaction is not what we’re looking for. Trying to manually submit the form by calling the form submit function I found out the submit name was DOM clobbered by a form input. Come on, lol! But finally a call to the delete profile picture worked out just fine. This function was well hidden but I found it by downloading all the obfuscated/concatenated javascript the site had to offer and analyzing it after deobfuscation.</p>

<p>Now there’s only one more thing: how do I make sure someone actually clicks on the link containing my attack? That depends given the context of the website. If it’s something like eBay you could add a link claiming there’s more info and pictures behind it. Given the context of the company I was attacking it was pretty easy to find a good reason.</p>

<p>The end result looked something like this (poc.html):</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- Profile picture deletion 'SOME attack' PoC --&gt;</span>

<span class="nt">&lt;button</span> <span class="na">onclick=</span><span class="s">"fire()"</span><span class="nt">&gt;</span>Click<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="kd">function</span> <span class="nx">fire</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">open</span><span class="p">(</span><span class="dl">'</span><span class="s1">javascript:setTimeout("location=</span><span class="se">\'</span><span class="s1">https://company.com/lib/upload.swf?target=opener.document.body.firstElementChild.nextElementSibling.nextElementSibling.nextElementSibling.nextElementSibling.nextElementSibling.firstElementChild.nextElementSibling...etc...firstElementChild.click&amp;uid=poc_kciredor&amp;</span><span class="se">\'</span><span class="s1">", 2000)</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">setTimeout</span><span class="p">(</span><span class="dl">'</span><span class="s1">location="https://company.com/profile/"</span><span class="dl">'</span><span class="p">)</span>
<span class="p">}</span>
<span class="nt">&lt;/script&gt;</span></code></pre></figure>

<p>What happens is this: A user is given the link to this poc.html and clicks the button. A new browser tab will be opened with our target location and after timeout the javascript will ‘click’ a DOM element that does the actual profile picture deletion. Done. My suggestion on how to fix this issue was simply to upgrade the library because the issue has been fixed in more recent versions.</p>

<h1 id="meanwhile">Meanwhile</h1>
<p>The ‘first month IDOR issue’ has been resolved by the company, but it’s still not published. As soon as it’s publically disclosed I’ll write a detailed blog post about it, without having to mask anything! During my second month I invested a lot of time, perhaps most of my time, into coding a successor of recon.sh. I kept on having to fix and customize recon.sh to work with each and every target I tried and it kept on crashing, etc. The new setup is what I call recon-docker. It’s a python/django dockerized set of scanners with a web frontend, leveraging the usual tools like masscan and recon-ng. For now I’m able to define targets with exact scope and let it run from one or more vm’s. If a tool crashes then recon-docker will recover and continue. Next up would be continues scanning and change detection: send me a push notification as soon as company X has new sub domain Y! Hoping this investment will help me in the long run.</p>

<h1 id="wrapping-stepping-up"><del>Wrapping</del> Stepping up</h1>
<p>So far I’ve found an IDOR in the first month, a SOME attack in the second month and an open S3 bucket (yet to be triaged) in the third month. Mixed feelings: out of nowhere I stepped into the world of bug bounties, having a professional background in software engineering, but not in information security let alone web hacking. So finding one bug each month so far as a beginner should be a good start… but it does not feel like it’s enough. Far from it! Bills will have to be paid for. I’m eager to pursue my dreams. So it’s time to step up my game. When I was young I fell in love with reverse engineering: disassemblers, debuggers, hex editors, you name it. Let’s find out what the possibilities are in that specific area of expertise: a healthy (?) mix between <em>binary exploitation/reverse engineering/vm escapes</em> and <em>web application hacking</em>.</p>

<p>Let’s keep on hacking!</p>

<p>Cheers,
kciredor</p>

<div class="jekyll-twitter-plugin"><blockquote class="twitter-tweet"><p lang="en" dir="ltr">&quot;First bounty, time to step up my game&quot; by <a href="https://twitter.com/kciredor_?ref_src=twsrc%5Etfw">@kciredor_</a> <a href="https://t.co/kEAo63fS9Z">https://t.co/kEAo63fS9Z</a> <a href="https://twitter.com/hashtag/bugbounty?src=hash&amp;ref_src=twsrc%5Etfw">#bugbounty</a> <a href="https://twitter.com/hashtag/infosec?src=hash&amp;ref_src=twsrc%5Etfw">#infosec</a></p>&mdash; Roderick Schaefer (@kciredor_) <a href="https://twitter.com/kciredor_/status/910148254695854083?ref_src=twsrc%5Etfw">September 19, 2017</a></blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>

  </div>

  <div class="post-sharing">
  <a rel="noopener noreferrer nofollow" target="_blank" href="https://twitter.com/intent/tweet?text=&quot;First bounty, time to step up my game&quot; by @kciredor_&url=https://kciredor.com/first-bounty-time-to-step-up-my-game.html&related=kciredor_"><img src="/assets/icon_twitter.png" alt="Twitter" title=""></a>
  <a rel="noopener noreferrer nofollow" target="_blank" href="http://www.reddit.com/submit?url=https://kciredor.com/first-bounty-time-to-step-up-my-game.html&title=First bounty, time to step up my game"><img src="/assets/icon_reddit.png" alt="Reddit" title=""></a>
  <a rel="noopener noreferrer nofollow" target="_blank" href="https://www.linkedin.com/sharing/share-offsite/?url=https://kciredor.com/first-bounty-time-to-step-up-my-game.html"><img src="/assets/icon_linkedin.png" alt="LinkedIn" title=""></a>
  <a rel="noopener noreferrer nofollow" target="_blank" href="https://facebook.com/sharer.php?href=https://kciredor.com/first-bounty-time-to-step-up-my-game.html&display=popup"><img src="/assets/icon_facebook.png" alt="Facebook" title=""></a>
</div>

  <p></p>

  
    <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'https://kciredor.com/first-bounty-time-to-step-up-my-game.html';
      this.page.identifier = 'https://kciredor.com/first-bounty-time-to-step-up-my-game.html';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://kciredor.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  
</article>

      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
    <h2 class="footer-heading">kciredor&#39;s software and security blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            
              Roderick Schaefer
            
            </li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          <li><a href="https://twitter.com/kciredor_" target="_blank" rel="nofollow noopener noreferrer">twitter</a></li>
          <li><a href="https://mastodon.social/@kciredor" target="_blank" rel="nofollow noopener noreferrer">mastodon</a></li>
          <li><a href="/feed.xml">rss feed</a></li>
          <li><a href="https://github.com/kciredor" target="_blank" rel="nofollow noopener noreferrer">github</a></li>
          <li><a href="https://www.linkedin.com/in/roderickschaefer/" target="_blank" rel="nofollow noopener noreferrer">linkedin</a></li>
          <li><a href="https://wehandle.it/" target="_blank" rel="nofollow noopener noreferrer">company</a></li>
          <li><a href="https://hackerone.com/kciredor" target="_blank" rel="nofollow noopener noreferrer">hackerone</a></li>
          <li><a href="https://bugcrowd.com/kciredor" target="_blank" rel="nofollow noopener noreferrer">bugcrowd</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>I&#39;m an independent software engineer and security researcher. This blog features my write-up&#39;s on interesting software and security topics. Make sure you follow me on Twitter @kciredor_ to stay up to date on new posts!
</p>
      </div>
    </div>
  </div>
</footer>
</body>

</html>
